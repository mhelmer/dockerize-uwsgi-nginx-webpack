apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: celery-deployment
spec:
  replicas: 2
  template:
    metadata:
      labels:
        app: celery
    spec:
      containers:
      - name: celery
        image: gcr.io/xs-amiable-bonus-6/django-image:1.7
        command: ["/usr/local/bin/entrypoint", "celery", "-A", "project", "worker", "-l", "warning"]
        env:
        - name: POSTGRES_USER
          value: "postgres"
        - name: POSTGRES_PASSWORD
          value: "secret-password"
        - name: DJANGO_SETTINGS_MODULE
          value: "project.settings.prod"
        - name: RABBITMQ_DEFAULT_USER
          value: "user"
        - name: RABBITMQ_DEFAULT_PASS
          value: "password"
        - name: SECRET_KEY
          value: "_i%mh%l&)sd*cqfrx0emua)o84+*!+5w29m%c03kqb4eym+6gc"
